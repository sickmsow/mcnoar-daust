<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MCNOAR — MindAR Anchored Overlay</title>
    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <!-- MindAR -->
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        font-family: system-ui, sans-serif;
      }
      .ui {
        position: fixed;
        top: 12px;
        left: 12px;
        right: 12px;
        display: flex;
        justify-content: space-between;
        gap: 12px;
        z-index: 50;
        pointer-events: none;
      }
      .ui .card {
        pointer-events: auto;
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 12px;
        border-radius: 10px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
        font-size: 14px;
      }
      .center-hint {
        position: fixed;
        bottom: 18px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 50;
        pointer-events: none;
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 12px;
        border-radius: 999px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
        font-size: 13px;
      }
      #debugInfo {
        position: fixed;
        top: 80px;
        left: 12px;
        background: rgba(0, 0, 0, 0.8);
        color: #0f0;
        padding: 12px;
        font-family: monospace;
        font-size: 12px;
        border-radius: 8px;
        z-index: 100;
        max-width: 300px;
      }
    </style>
  </head>
  <body>
    <div class="ui">
      <div class="card">
        <strong>MindAR Anchored Overlay</strong><br />
        Point your camera at the target image.
      </div>
      <div class="card" id="status">Status: <strong>Waiting</strong></div>
    </div>
    <div class="center-hint" id="hint">Scanning for target image...</div>
    <div id="debugInfo">Loading MindAR...</div>
    
    <a-scene
      mindar-image="imageTargetSrc: assets/demo.mind; autoStart: true; uiLoading: no; uiError: no; uiScanning: no;"
      color-space="sRGB"
      renderer="colorManagement: true; physicallyCorrectLights: true; alpha: true;"
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false"
    >
      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
      
      <!-- Target 0 - This anchors to the first image in demo.mind -->
      <a-entity mindar-image-target="targetIndex: 0" id="target">
        
        <!-- Red Box Placeholder (Anchor Plane) -->
        <a-plane
          position="0 0 0"
          rotation="0 0 0"
          width="1"
          height="1"
          material="color: red; opacity: 0.7; transparent: true;"
        ></a-plane>
        
        <!-- Top Text - Above the image -->
        <a-text
          value="Artwork Title — 1950"
          align="center"
          width="1.5"
          color="#ffffff"
          position="0 0.7 0.01"
          scale="1.5 1.5 1"
        ></a-text>
        
        <!-- Left Text -->
        <a-entity position="-0.8 0 0.01">
          <a-text
            value="Historical Info:\nSymbolizes unity\nand strength."
            align="left"
            width="1"
            color="#ffcc00"
            scale="1.2 1.2 1"
          ></a-text>
        </a-entity>
        
        <!-- Right Text -->
        <a-entity position="0.8 0 0.01">
          <a-text
            value="Artist:\nJane Doe\n(1952)"
            align="right"
            width="1"
            color="#00ccff"
            scale="1.2 1.2 1"
          ></a-text>
        </a-entity>
        
      </a-entity>
    </a-scene>
    
    <script>
      const target = document.querySelector("#target");
      const statusEl = document.querySelector("#status");
      const hintEl = document.querySelector("#hint");
      const debugInfo = document.querySelector("#debugInfo");
      
      let targetVisible = false;
      
      // Scene loaded
      document.querySelector('a-scene').addEventListener('renderstart', () => {
        debugInfo.innerHTML = "✓ MindAR loaded<br>✓ Camera active<br>Scanning for target...";
        console.log("MindAR scene started");
      });
      
      // Target found
      target.addEventListener("targetFound", () => {
        targetVisible = true;
        statusEl.innerHTML = "Status: <strong style='color: #0a0'>Target detected ✓</strong>";
        hintEl.innerText = "AR overlay active!";
        debugInfo.innerHTML = "✓ MindAR loaded<br>✓ Camera active<br><strong style='color: #0f0'>✓ TARGET FOUND!</strong>";
        console.log("Target found!");
      });
      
      // Target lost
      target.addEventListener("targetLost", () => {
        targetVisible = false;
        statusEl.innerHTML = "Status: <strong style='color: #f60'>Target lost</strong>";
        hintEl.innerText = "Hold camera steady on the target.";
        debugInfo.innerHTML = "✓ MindAR loaded<br>✓ Camera active<br><span style='color: #f60'>⚠ Target lost</span>";
        console.log("Target lost");
      });
      
      // Periodic status update
      setInterval(() => {
        if (!targetVisible) {
          debugInfo.innerHTML = "✓ MindAR loaded<br>✓ Camera active<br>Scanning for target...";
        }
      }, 3000);
    </script>
  </body>
</html>